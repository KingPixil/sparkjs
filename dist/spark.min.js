/*
* Spark v0.1.2
* Copyright 2016-2017, Kabir Shah
* https://github.com/KingPixil//
* Free to use under the MIT license.
* https://kingpixil.github.io/license
*/
!function(t,s){"object"==typeof module&&module.exports?module.exports=s():t.Spark=s()}(this,function(){function t(t){t=t||{},this.map=t.map||{},this.frequency=t.frequency||{},this.lines=t.lines||[],this.vocab=t.vocab||[],this.startWords=t.startWords||[],this.sentences=t.sentences||3,this.endWords=t.endWords||{}}function s(t){this.opts=t||{},this.vocab={},this.totalVocab={},this.documents={},this.totalDocs=0,this.train=function(t,s){var o=t.split(" ");this.totalDocs++,this.vocab[s]||(this.vocab[s]={}),this.documents[s]?this.documents[s]++:this.documents[s]=1,this.totalVocab[s]||(this.totalVocab[s]=0);for(var i=0;i<o.length;i++){var r=o[i];this.totalVocab[s]++,void 0===this.vocab[s][r]?this.vocab[s][r]=1:this.vocab[s][r]++}},s.getPriorProb=function(t,s){return t/s},s.max=function(t){return Object.keys(t).reduce(function(s,o){return t[s]>t[o]?s:o})},s.toObj=function(t){for(var s={},o=0;o<t.length;o++)s[t[o]]?s[t[o]]++:s[t[o]]=1;return s},s.getState=function(){return{vocab:this.vocab,totalVocab:this.totalVocab,documents:this.totalDocuments,totalDocs:this.totalDocs}},s.classify=function(t){var s={},o=this.toObj(t.split(" "));for(var i in this.vocab){var r=this.getPriorProb(this.documents[i],this.totalDocs);s[i]=r;for(var a in this.vocab[i])o[a]?s[i]*=(this.vocab[i][a]+1)/(this.documents[i]+this.totalVocab[i]):s[i]*=1-(this.vocab[i][a]+1)/(this.documents[i]+this.totalVocab[i]);s[i]=s[i]/r+(1-s[i])*(1-r)}var n=this.max(s);return this.opts.verbose?{confidence:s,choice:n}:n}}var o={MarkovChain:t,NaiveBayes:s},i=function(t){return t[Math.floor(Math.random()*t.length)]};return t.prototype.train=function(t){this.data=t,this.lines=this.data.replace(/([.?!])\s*(?=[A-Z])/g,"$1|").split("|");for(var s=0;s<this.lines.length;s++){for(var o=this.lines[s],i=o.split(" "),r=[],a=0;a<i.length;a+=2)i[a+1]?r.push(i[a]+" "+i[a+1]):r.push(i[a]);this.startWords.push(r[0]),this.endWords[r[r.length-1]]=!0;for(var a=0;a<r.length;a++)this.vocab.push(r[a]),this.map[r[a]]?this.map[r[a]].push(r[a+1]):this.map[r[a]]=[r[a+1]]}},t.prototype.generate=function(t){if(t=t||{},this.start=i(this.startWords),t.start){var s=this.startWords.filter(function(s){return t.start.test(s)});this.start=i(s)}t.end&&(this.endWords={},this.endWords[t.end]=!0);for(var o=this.start,r=[o];this.map.hasOwnProperty(o);){var a=i(this.map[o]);if(r.push(a),o=a,this.endWords.hasOwnProperty(a)||this.map[a]===[void 0])break}return r.join(" ")},t.prototype.predict=function(t){return i(this.map[t])},t.prototype.getState=function(){return this},o});