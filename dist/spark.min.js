/*
* Spark v0.0.1
* Copyright 2016, Kabir Shah
* https://github.com/KingPixil//
* Free to use under the MIT license.
* https://kingpixil.github.io/license
*/
function classifier(){this.data={},this.total=0,this.vocab=[],this.frequency={},this.confidence=0}function markov(t){this.sentence=[],this.map={},this.starters=[],this.opts=t}var Spark={markov:markov,classifier:classifier};classifier.prototype.train=function(t,s){var r=s.split(/[\s]/gi);this.data[t]?(this.data[t].words.push.apply(this.data[t].words,r),this.data[t].total++):this.data[t]={words:r,frequency:{},total:1},this.total+=r.length},classifier.prototype.seed=function(){for(var t in this.data){var s=this.data[t];s.prior=s.words.length/this.total;for(var r in s.words)s.frequency[s.words[r]]?s.frequency[s.words[r]]++:s.frequency[s.words[r]]=1,this.vocab.indexOf(s.words[r])===-1&&this.vocab.push(s.words[r]),this.frequency[s.words[r]]?this.frequency[s.words[r]]++:this.frequency[s.words[r]]=1;var e=s.words.filter(function(t,r){return s.words.indexOf(t)==r});s.words=e}},classifier.prototype.classify=function(t){var s=null,r=0,e=0,i=t.split(/[\s]/gi);this.seed();for(var a=0;a<i.length;a++){var o=i[a];for(var n in this.data)r+=this.data[n].frequency[o]?this.data[n].frequency[o]/this.data[n].total*this.data[n].prior/(this.frequency[o]/this.total):1-this.data[n].prior,r>e&&(e=r,r=0,s=n)}return s},markov.prototype.seed=function(t){for(var s=0;s<t.length;s++){var r=this.toWords(t[s]);this.starters.push(r[0]);for(var e=0;e<r.length;e++)this.map.hasOwnProperty(r[e])?this.map[r[e]].push(r[e+1]):this.map[r[e]]=[r[e+1]]}},markov.prototype.randomElement=function(t){return t[Math.floor(Math.random()*t.length)]},markov.prototype.toWords=function(t){return t.split(" ")},markov.prototype.clear=function(){this.sentence=[],this.map={},this.starters=[]},markov.prototype.train=function(t){this.seed(t)},markov.prototype.generate=function(){var t=this.randomElement(this.starters);for(this.sentence.push(t);this.map.hasOwnProperty(t);){var s=this.sentence[this.sentence.length-1];if(t=this.randomElement(this.map[s]),this.sentence.push(t),this.sentence.length>this.opts.min&&this.sentence.length<this.opts.max&&this.map[s]===[null])break}var r=this.sentence.join(" ");return this.clear(),r};